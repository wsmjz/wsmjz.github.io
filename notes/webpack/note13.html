<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack中必须掌握的配置 | 苹果家+</title>
    <meta name="description" content="苹果家+，不只是代码，更是一群朋友的空间">
    
    
    <link rel="preload" href="/vuepress/assets/css/0.styles.9f7574c5.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.e32c95c2.js" as="script"><link rel="preload" href="/vuepress/assets/js/2.9a8b6d54.js" as="script"><link rel="preload" href="/vuepress/assets/js/18.c5937895.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.11b9baea.js"><link rel="prefetch" href="/vuepress/assets/js/11.87d43144.js"><link rel="prefetch" href="/vuepress/assets/js/12.88b4be69.js"><link rel="prefetch" href="/vuepress/assets/js/13.b75736a5.js"><link rel="prefetch" href="/vuepress/assets/js/14.a2e178ee.js"><link rel="prefetch" href="/vuepress/assets/js/15.b2082756.js"><link rel="prefetch" href="/vuepress/assets/js/16.8d3efe6f.js"><link rel="prefetch" href="/vuepress/assets/js/17.cb5dd6a4.js"><link rel="prefetch" href="/vuepress/assets/js/19.0d0c9d0c.js"><link rel="prefetch" href="/vuepress/assets/js/20.29c9b6c6.js"><link rel="prefetch" href="/vuepress/assets/js/3.523eba35.js"><link rel="prefetch" href="/vuepress/assets/js/4.583dc5ab.js"><link rel="prefetch" href="/vuepress/assets/js/5.e91b76f4.js"><link rel="prefetch" href="/vuepress/assets/js/6.53c1b3df.js"><link rel="prefetch" href="/vuepress/assets/js/7.808eccaf.js"><link rel="prefetch" href="/vuepress/assets/js/8.3165a768.js"><link rel="prefetch" href="/vuepress/assets/js/9.fab58f37.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.9f7574c5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress/" class="home-link router-link-active"><!----> <span class="site-name">苹果家+</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">核心</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/Api.html" class="nav-link">重要Api</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/vue.html" class="nav-link">Vue概记</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/react.html" class="nav-link">React概记</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/webpack/my_webpack.html" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/note12.html" class="nav-link">zf-webpack</a></li></ul></div></div><div class="nav-item"><a href="/vuepress/webpack/zaji/base.html" class="nav-link">杂记</a></div><div class="nav-item"><a href="/vuepress/webpack/Cansee/base.html" class="nav-link">可视化</a></div><div class="nav-item"><a href="/vuepress/xcx.html" class="nav-link">小程序</a></div><div class="nav-item"><a href="/vuepress/cli.html" class="nav-link">脚手架</a></div><div class="nav-item"><a href="/vuepress/webpack/node_note/base/note.html" class="nav-link">node.js</a></div><div class="nav-item"><a href="/vuepress/guoxue.html" class="nav-link">国学</a></div> <a href="https://github.com/wsmjz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">核心</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/Api.html" class="nav-link">重要Api</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/vue.html" class="nav-link">Vue概记</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/Core/react.html" class="nav-link">React概记</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/webpack/my_webpack.html" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress/webpack/note12.html" class="nav-link">zf-webpack</a></li></ul></div></div><div class="nav-item"><a href="/vuepress/webpack/zaji/base.html" class="nav-link">杂记</a></div><div class="nav-item"><a href="/vuepress/webpack/Cansee/base.html" class="nav-link">可视化</a></div><div class="nav-item"><a href="/vuepress/xcx.html" class="nav-link">小程序</a></div><div class="nav-item"><a href="/vuepress/cli.html" class="nav-link">脚手架</a></div><div class="nav-item"><a href="/vuepress/webpack/node_note/base/note.html" class="nav-link">node.js</a></div><div class="nav-item"><a href="/vuepress/guoxue.html" class="nav-link">国学</a></div> <a href="https://github.com/wsmjz" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vuepress/" class="sidebar-link">首页</a></li><li><a href="/vuepress/Core/Api.html" class="sidebar-link">重要Api</a></li><li><a href="/vuepress/Core/vue.html" class="sidebar-link">Vue概记</a></li><li><a href="/vuepress/Core/react.html" class="sidebar-link">React概记</a></li><li><a href="/vuepress/webpack/my_webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/vuepress/webpack/note12.html" class="sidebar-link">zf-webpack</a></li><li><a href="/vuepress/zaji/base.html" class="sidebar-link">杂记</a></li><li><a href="/vuepress/Cansee/base.html" class="sidebar-link">可视化</a></li><li><a href="/vuepress/xcx.html" class="sidebar-link">小程序</a></li><li><a href="/vuepress/cli.html" class="sidebar-link">脚手架</a></li><li><a href="/vuepress/node_note/base/note.html" class="sidebar-link">node.js</a></li><li><a href="/vuepress/guoxue.html" class="sidebar-link">国学</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack中必须掌握的配置"><a href="#webpack中必须掌握的配置" aria-hidden="true" class="header-anchor">#</a> Webpack中必须掌握的配置</h1> <p>loader主要用于把模块原内容按照需求转换成新内容，可以加载非 JS 模块！<br>
通过使用不同的Loader，Webpack可以把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等。</p> <p>我们来看看这些我们必须掌握的loader!</p> <h2 id="_1-loader的编写"><a href="#_1-loader的编写" aria-hidden="true" class="header-anchor">#</a> 1.loader的编写</h2> <h3 id="_1-1-loader的使用"><a href="#_1-1-loader的使用" aria-hidden="true" class="header-anchor">#</a> 1.1 loader的使用</h3> <ul><li>test：匹配处理文件的扩展名的正则表达式</li> <li>use：loader名称，就是你要使用模块的名称</li> <li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li> <li>options:为loaders提供额外的设置选项</li></ul> <p>默认<code>loader</code>的顺序是<strong>从下到上</strong>、<strong>从右向左</strong>执行，当然执行顺序也可以手动定义的，接下来我们依次介绍常见的loader，来感受<code>loader</code>的魅力!</p> <p>我们基于这个基础配置来继续编写:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dev <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.dev&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> prod <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.prod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span><span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
        template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../public/template.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        cleanOnceBeforeBuildPatterns<span class="token punctuation">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'xxxx/*'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'**/*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">env</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>development<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> dev<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_2-处理css文件"><a href="#_2-处理css文件" aria-hidden="true" class="header-anchor">#</a> 2.处理CSS文件</h2> <h3 id="_2-1-解析css样式"><a href="#_2-1-解析css样式" aria-hidden="true" class="header-anchor">#</a> 2.1 解析css样式</h3> <p>我们在<code>js</code>文件中引入css样式！</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">'./index.css'</span><span class="token punctuation">;</span>
</code></pre></div><p>再次执行打包时，会提示css无法解析</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ERROR <span class="token keyword">in</span> ./src/index.css <span class="token number">1</span>:4
Module parse failed: Unexpected token <span class="token punctuation">(</span><span class="token number">1</span>:4<span class="token punctuation">)</span>
You may need an appropriate loader to handle this <span class="token function">file</span> type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts<span class="token comment">#loaders</span>
</code></pre></div><p><strong>安装loader</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> style-loader css-loader --save-dev
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
       test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
       use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-抽离样式文件"><a href="#_2-2-抽离样式文件" aria-hidden="true" class="header-anchor">#</a> 2.2 抽离样式文件</h3> <p>默认只在打包时进行样式抽离</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">env</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> isDev <span class="token operator">=</span> env<span class="token punctuation">.</span>development<span class="token punctuation">;</span>
  <span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/*source...*/</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> dev<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>安装抽离插件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> mini-css-extract-plugin --save-dev
</code></pre></div><p>配置抽离插件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
        isDev <span class="token operator">&amp;&amp;</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
        <span class="token string">&quot;css-loader&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">&quot;css/[name].css&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>最终文件配置贴一下:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dev <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.dev&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> prod <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.prod&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">env</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> isDev <span class="token operator">=</span> env<span class="token punctuation">.</span>development<span class="token punctuation">;</span>
  <span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      filename<span class="token punctuation">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span>
      path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
          use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
            isDev <span class="token operator">&amp;&amp;</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
            <span class="token string">&quot;css-loader&quot;</span>
          <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          filename<span class="token punctuation">:</span> <span class="token string">&quot;css/[name].css&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          filename<span class="token punctuation">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span>
          template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../public/template.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDev<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> dev<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> prod<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-3-css预处理器"><a href="#_2-3-css预处理器" aria-hidden="true" class="header-anchor">#</a> 2.3 css预处理器</h3> <p>不同的css预处理器要安装不同的loader来进行解析</p> <ul><li>sass: sass-loader node-sass</li> <li>less: less-loader less</li> <li>stylus: stylus-loader stylus</li></ul> <p>使用<code>sass</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
        isDev <span class="token operator">&amp;&amp;</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
        <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;sass-loader&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在css文件中可能会使用<code>@import</code>语法引用<code>css</code>文件,被引用的<code>css</code>文件中可能还会导入<code>scss</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
    isDev <span class="token operator">&amp;&amp;</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span><span class="token punctuation">{</span>
            importLoaders<span class="token punctuation">:</span><span class="token number">1</span> <span class="token comment">// 引入的文件需要调用sass-loader来处理 </span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sass-loader&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_2-4-处理样式前缀"><a href="#_2-4-处理样式前缀" aria-hidden="true" class="header-anchor">#</a> 2.4 处理样式前缀</h3> <p>使用<code>postcss-loader</code>增加样式前缀</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> postcss-loader autoprefixer
</code></pre></div><p>在处理css前先增加前缀</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
    isDev <span class="token operator">&amp;&amp;</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span><span class="token punctuation">{</span>
            plugins<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sass-loader&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>或者也可以创建<code>postcss</code>的配置文件<code>postcss.config.js</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以配置浏览器的兼容性范围  <a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener noreferrer">.browserslistrc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>cover 99.5%
</code></pre></div><h3 id="_2-5-css压缩"><a href="#_2-5-css压缩" aria-hidden="true" class="header-anchor">#</a> 2.5 css压缩</h3> <p>在生产环境下我们需要压缩<code>css</code>文件,配置<code>minimizer</code>选项,安装压缩插件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i optimize-css-assets-webpack-plugin terser-webpack-plugin --save-dev
</code></pre></div><p>在<code>webpack.prod.js</code>文件中配置压缩</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserJSPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
optimization<span class="token punctuation">:</span><span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserJSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-6-文件指纹"><a href="#_2-6-文件指纹" aria-hidden="true" class="header-anchor">#</a> 2.6 文件指纹</h3> <ul><li>Hash整个项目的hash值</li> <li>chunkhash 根据入口产生hash值</li> <li>contentHash 根据每个文件的内容产生的hash值</li></ul> <p>我们可以合理的使用<code>hash</code>戳，进行文件的缓存</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">!</span>isDev <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">&quot;css/[name].[contentHash].css&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-处理文件类型"><a href="#_3-处理文件类型" aria-hidden="true" class="header-anchor">#</a> 3.处理文件类型</h2> <h3 id="_3-1-处理引用的图片"><a href="#_3-1-处理引用的图片" aria-hidden="true" class="header-anchor">#</a> 3.1 处理引用的图片</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> logo <span class="token keyword">from</span> <span class="token string">'./webpack.png'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> logo<span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用<code>file-loader</code>,会将图片进行打包，并将打包后的路径返回</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.jpe?g|png|gif/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">'file-loader'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span><span class="token punctuation">{</span>
            name<span class="token punctuation">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">img/[name].[ext]</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-2-处理icon"><a href="#_3-2-处理icon" aria-hidden="true" class="header-anchor">#</a> 3.2 处理icon</h3> <p>二进制文件也是使用<code>file-loader</code>来打包</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/woff|ttf|eot|svg|otf/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">'file-loader'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-3-转化成base64"><a href="#_3-3-转化成base64" aria-hidden="true" class="header-anchor">#</a> 3.3 转化成base64</h3> <p>使用<code>url-loader</code>将满足条件的图片转化成base64,不满足条件的<code>url-loader</code>会自动调用<code>file-loader</code>来进行处理</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.jpe?g|png|gif/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span><span class="token punctuation">{</span>
            limit<span class="token punctuation">:</span><span class="token number">100</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">img/[name].[ext]</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_4-处理js模块"><a href="#_4-处理js模块" aria-hidden="true" class="header-anchor">#</a> 4.处理JS模块</h2> <h3 id="_4-1-将es6代码编译成es5代码"><a href="#_4-1-将es6代码编译成es5代码" aria-hidden="true" class="header-anchor">#</a> 4.1 将<code>es6</code>代码编译成<code>es5</code>代码</h3> <p>代码的转化工作要交给<code>babel</code>来处理</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/core @babel/preset-env babel-loader --save-dev
</code></pre></div><p><code>@babel/core</code>是babel中的核心模块，<code>@babel/preset-env</code> 的作用是es6转化es5插件的插件集合，<code>babel-loader</code>是<code>webpack</code>和<code>loader</code>的桥梁。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>增加<code>babel</code>的配置文件 <code>.babelrc</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>配置loader</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
	rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span> use<span class="token punctuation">:</span> <span class="token string">&quot;babel-loader&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>现在打包已经可以成功的将es6语法转化成es5语法！</p> <h3 id="_4-2-解析装饰器"><a href="#_4-2-解析装饰器" aria-hidden="true" class="header-anchor">#</a> 4.2 解析装饰器</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i @babel/plugin-proposal-class-properties @babel/plugin-proposal-decorators --save-dev
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;loose&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre></div><p><code>legacy:true</code>表示继续使用装饰器装饰器，loose为false时会采用<code>Object.defineProperty</code>定义属性</p> <ul><li>Plugin会运行在Preset之前</li> <li>Plugin 会从第一个开始顺序执行，Preset则是相反的</li></ul> <h3 id="_4-3-polyfill"><a href="#_4-3-polyfill" aria-hidden="true" class="header-anchor">#</a> 4.3 polyfill</h3> <p>根据<code>.browserslistrc</code>文件，转化使用到的浏览器api</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;presets&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token string">&quot;useBuiltIns&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 按需加载</span>
        <span class="token string">&quot;corejs&quot;</span><span class="token punctuation">:</span><span class="token number">2</span> <span class="token comment">// corejs 替代了以前的pollyfill</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre></div><p>安装corejs</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> core-js@2 --save
</code></pre></div><blockquote><p><strong>使用<code>transform-runtime</code></strong>
A plugin that enables the re-use of Babel's injected helper code to save on codesize.可以帮我们节省代码</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev @babel/plugin-transform-runtime @babel/runtime
</code></pre></div><p>在<code>.babelrc</code>中配置插件</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="_4-4-添加eslint"><a href="#_4-4-添加eslint" aria-hidden="true" class="header-anchor">#</a> 4.4 添加eslint</h3> <p>安装<code>eslint</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> eslint
npx eslint --init <span class="token comment"># 初始化配置文件</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>{
    test:/\.js/,
    enforce:'pre',
    use:'eslint-loader'
},
</code></pre></div><blockquote><p>配置<code>eslint-loader</code>可以实时校验js文件的正确性,<code>pre</code>表示在所有<code>loader</code>执行前执行</p></blockquote> <h2 id="_5-source-map"><a href="#_5-source-map" aria-hidden="true" class="header-anchor">#</a> 5.source-map</h2> <ul><li>eval 生成代码 每个模块都被eval执行,每一个打包后的模块后面都增加了包含sourceURL</li> <li>source-map 产生map文件</li> <li>inline 不会生成独立的 .map文件,会以dataURL形式插入</li> <li>cheap 忽略打包后的列信息，不使用loader中的sourcemap</li> <li>module 没有列信息，使用loader中的sourcemap(没有列信息)</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>devtool<span class="token punctuation">:</span>isDev<span class="token operator">?</span><span class="token string">'cheap-module-eval-source-map'</span><span class="token punctuation">:</span><span class="token boolean">false</span>
</code></pre></div><blockquote><p>每个库中采用的<code>sourcemap</code>方式不一,可以根据自己的需要自行配置</p></blockquote> <h2 id="_6-resolve解析"><a href="#_6-resolve解析" aria-hidden="true" class="header-anchor">#</a> 6.resolve解析</h2> <p>想实现使用require或是import的时候,可以自动尝试添加扩展名进行匹配</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.jsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.tsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_7-拷贝静态文件"><a href="#_7-拷贝静态文件" aria-hidden="true" class="header-anchor">#</a> 7.拷贝静态文件</h2> <p>有些时候在打包时希望将一些静态资源文件进行拷贝,可以使用<code>copy-webpack-plugin</code></p> <p>安装插件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i copy-webpack-plugin --save-dev
</code></pre></div><p>使用拷贝插件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token keyword">from</span><span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./src/static'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>to<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_8-配置ts环境"><a href="#_8-配置ts环境" aria-hidden="true" class="header-anchor">#</a> 8.配置TS环境</h2> <h3 id="_8-1-使用ts-loader"><a href="#_8-1-使用ts-loader" aria-hidden="true" class="header-anchor">#</a> 8.1 使用ts-loader</h3> <p>使用<code>ts</code>需要安装<code>ts</code>相关配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> typescript ts-loader --save-dev
</code></pre></div><p>生成<code>ts</code>的配置文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code>npx tsc --init
</code></pre></div><p>配置<code>ts-loader</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.tsx?/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ts-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将入口文件更改成<code>ts</code>文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a<span class="token punctuation">:</span>string <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>执行<code>npm run dev</code>发现已经可以正常的解析<code>ts</code>文件啦！</p> <h3 id="_8-2-使用-preset-typescript"><a href="#_8-2-使用-preset-typescript" aria-hidden="true" class="header-anchor">#</a> 8.2 使用 preset-typescript</h3> <p>不需要借助<code>typescript</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/preset-typescript
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span><span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;corejs&quot;</span><span class="token operator">:</span><span class="token number">2</span> 
       <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-typescript&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
           <span class="token property">&quot;allExtensions&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>  
       <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;loose&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-配置ts-react环境"><a href="#_9-配置ts-react环境" aria-hidden="true" class="header-anchor">#</a> 9.配置ts+react环境</h2> <p>安装<code>react</code>相关模块</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i @babel/preset-react --save-dev <span class="token comment"># 解析jsx语法</span>
<span class="token function">npm</span> i react @types/react @types/react-dom react react-dom typescript
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token builtin">number</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> State <span class="token operator">=</span> Readonly<span class="token operator">&lt;</span><span class="token keyword">typeof</span> state<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token operator">&lt;</span>object<span class="token punctuation">,</span>State<span class="token operator">&gt;</span><span class="token punctuation">{</span>
    state<span class="token punctuation">:</span>State <span class="token operator">=</span> state
    <span class="token function-variable function">handleClick</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token builtin">number</span><span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token builtin">number</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token builtin">number</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token builtin">number</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Counter<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Counter<span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_10-配置ts-vue环境"><a href="#_10-配置ts-vue环境" aria-hidden="true" class="header-anchor">#</a> 10.配置ts+vue环境</h2> <p>安装<code>vue</code>所需要的模块</p> <div class="language- extra-class"><pre class="language-text"><code>npm install vue-loader  vue-template-compiler --save-dev
npm install vue vue-property-decorator 
</code></pre></div><p>配置<code>ts-loader</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.tsx?/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span><span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            appendTsSuffixTo<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token regex">/\.vue$/</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用<code>vue-loader</code>插件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> VueLoaderPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-loader/lib/plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>配置解析<code>.vue</code>文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span><span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token string">'vue-loader'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>增加<code>vue-shims.d.ts</code>，可以识别<code>.vue</code>文件</p> <div class="language- extra-class"><pre class="language-text"><code>declare module '*.vue' {
    import Vue from 'vue';
    export default Vue;
}
</code></pre></div><p><code>index.tsx</code>文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">render</span><span class="token punctuation">:</span><span class="token parameter">h</span><span class="token operator">=&gt;</span><span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
</code></pre></div><p><code>App.vue文件</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(todo,index) in todos<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{todo}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span>Vue<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span><span class="token punctuation">;</span>
@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> todos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'香蕉'</span><span class="token punctuation">,</span><span class="token string">'苹果'</span><span class="token punctuation">,</span><span class="token string">'橘子'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_11-配置代理"><a href="#_11-配置代理" aria-hidden="true" class="header-anchor">#</a> 11.配置代理</h2> <p>设置服务端接口</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/list'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'香蕉'</span><span class="token punctuation">,</span> <span class="token string">'苹果'</span><span class="token punctuation">,</span> <span class="token string">'橘子'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>安装<code>axios</code>获取数据</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install axios <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>配置接口请求</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(todo,index) in todos<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            {{todo}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Component <span class="token punctuation">,</span>Vue<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-property-decorator'</span><span class="token punctuation">;</span>
@Component
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> todos<span class="token punctuation">:</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">async</span> <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span>  <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> data
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>配置服务器代理路由</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">:</span> <span class="token string">'http://localhost:4000'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/24/2019, 5:46:57 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.e32c95c2.js" defer></script><script src="/vuepress/assets/js/2.9a8b6d54.js" defer></script><script src="/vuepress/assets/js/18.c5937895.js" defer></script>
  </body>
</html>
